{% extends 'admin/base.html' %}

{% block title %}Edit Notice{% endblock %}

{% block content_title %}Edit Notice: {{ notice.title }}{% endblock %}

{% block content %}
<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    
    <div class="form-group">
        <label for="title">Title *</label>
        <input type="text" id="title" name="title" value="{{ notice.title }}" required>
    </div>
    
    <div class="form-group">
        <label for="notice_type">Notice Type *</label>
        <select id="notice_type" name="notice_type" required>
            <option value="">Select notice type</option>
            <option value="general" {% if notice.notice_type == 'general' %}selected{% endif %}>General Notice</option>
            <option value="menu" {% if notice.notice_type == 'menu' %}selected{% endif %}>Menu Update</option>
            <option value="event" {% if notice.notice_type == 'event' %}selected{% endif %}>Event Announcement</option>
            <option value="promotion" {% if notice.notice_type == 'promotion' %}selected{% endif %}>Promotion</option>
            <option value="alert" {% if notice.notice_type == 'alert' %}selected{% endif %}>Important Alert</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="content">Content *</label>
        <textarea id="content" name="content" rows="6" required>{{ notice.content }}</textarea>
    </div>
    
    <div class="form-group">
        <label for="image">Image</label>
        {% if notice.image %}
        <div style="margin-bottom: 10px;">
            <img src="{{ notice.image.url }}" alt="{{ notice.title }}" style="max-width: 200px; max-height: 150px; object-fit: cover; border-radius: 5px;">
            <p style="margin: 5px 0; color: #666; font-size: 14px;">Current image</p>
        </div>
        {% endif %}
        <input type="file" id="image" name="image" accept="image/*">
        <small style="color: #666; display: block; margin-top: 5px;">
            {% if notice.image %}Upload a new image to replace the current one.{% else %}Upload an image for this notice.{% endif %}
        </small>
    </div>
    
    <div class="form-group">
        <label for="document">Document</label>
        {% if notice.document %}
        <div style="margin-bottom: 10px;">
            <a href="{{ notice.document.url }}" target="_blank" style="color: #2d6a4f; text-decoration: none;">
                ðŸ“„ {{ notice.document.name|basename }}
            </a>
            <p style="margin: 5px 0; color: #666; font-size: 14px;">Current document</p>
        </div>
        {% endif %}
        <input type="file" id="document" name="document" accept=".pdf,.doc,.docx,.txt">
        <small style="color: #666; display: block; margin-top: 5px;">
            {% if notice.document %}Upload a new document to replace the current one.{% else %}Upload a document for this notice.{% endif %}
        </small>
    </div>
    
    <div class="form-group">
        <label for="expires_at">Expiration Date (Optional)</label>
        <input type="datetime-local" id="expires_at" name="expires_at" 
               {% if notice.expires_at %}value="{{ notice.expires_at|date:'Y-m-d\TH:i' }}"{% endif %}>
        <small style="color: #666; display: block; margin-top: 5px;">
            Leave blank for no expiration. Notice will be automatically hidden after this date.
        </small>
    </div>
    
    <div class="form-group">
        <div class="checkbox-group">
            <input type="checkbox" id="is_active" name="is_active" {% if notice.is_active %}checked{% endif %}>
            <label for="is_active">Active (visible to users)</label>
        </div>
    </div>
    
    <div class="form-group">
        <div class="checkbox-group">
            <input type="checkbox" id="is_featured" name="is_featured" {% if notice.is_featured %}checked{% endif %}>
            <label for="is_featured">Featured (display prominently)</label>
        </div>
    </div>
    
    <div style="margin-top: 2rem;">
        <button type="submit" class="btn">Update Notice</button>
        <a href="{% url 'manage_notices' %}" class="btn btn-secondary" style="margin-left: 10px;">Cancel</a>
    </div>
</form>
{% endblock %}
